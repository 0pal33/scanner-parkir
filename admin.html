<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Admin</title>

<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>

<style>
body{text-align:center;font-family:Arial;background:#eee}
input{padding:10px;margin:10px}
button{padding:12px;margin:10px}
</style>
</head>
<body>

<div id="loginBox">
<input id="email" placeholder="Email"><br>
<input id="pass" type="password" placeholder="Password"><br>
<button onclick="login()">Login</button>
<button onclick="location.href='index.html'">Batal</button>
</div>

<div id="dashboard" style="display:none">
<h2>Dashboard</h2>
<table border="1" align="center">
<tr><th></th><th>Checkout</th><th>Total</th></tr>
<tr><td>Hari Ini</td><td id="hC">0</td><td id="hT">0</td></tr>
<tr><td>Minggu Ini</td><td id="mC">0</td><td id="mT">0</td></tr>
<tr><td>Bulan Ini</td><td id="bC">0</td><td id="bT">0</td></tr>
</table>
<button onclick="logout()">Logout</button>
</div>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyCbB2eqYAxCM1DvkSyCyoqKwq39mvCBwCQ",
  authDomain: "parkir-demo.firebaseapp.com",
  projectId: "parkir-demo",
  storageBucket: "parkir-demo.firebasestorage.app",
  messagingSenderId: "962001897575",
  appId: "1:962001897575:web:811c1902e3a274f7bb6cc2"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

function login(){
firebase.auth().signInWithEmailAndPassword(
document.getElementById("email").value,
document.getElementById("pass").value
).then(()=>{
document.getElementById("loginBox").style.display="none";
document.getElementById("dashboard").style.display="block";
load();
});
}

function logout(){
firebase.auth().signOut();
location.reload();
}

function load(){
let today=new Date().toDateString();

db.collection("checkout").get().then(snap=>{
let c=0,t=0;
snap.forEach(d=>{
let data=d.data();
if(data.checkoutAt.toDate().toDateString()==today){
c++; t+=data.bayar;
}
});
document.getElementById("hC").innerText=c;
document.getElementById("hT").innerText=t;
});
}
</script>
</body>
</html>
